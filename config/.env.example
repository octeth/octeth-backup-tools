# ============================================
# Octeth Backup Tool - Environment Configuration
# ============================================
# Copy this file to .env and configure your settings
# Usage: cp config/.env.example config/.env

# ============================================
# MySQL Connection Settings
# ============================================
# These should match your Octeth installation

# MySQL container name or host
MYSQL_HOST=oempro_mysql

# MySQL port (3306 is default)
MYSQL_PORT=3306

# MySQL root password (required for XtraBackup)
MYSQL_ROOT_PASSWORD=your_root_password_here

# MySQL database name to backup (usually 'oempro')
MYSQL_DATABASE=oempro

# MySQL user (used for connection tests)
MYSQL_USERNAME=oempro
MYSQL_PASSWORD=your_mysql_password_here

# MySQL data directory on HOST (required for XtraBackup)
# This is the path to MySQL data directory on the host filesystem
# For Octeth Docker installations, this is typically the volume mount path
# Example for Octeth: /opt/oempro/_dockerfiles/mysql/data_v8
MYSQL_DATA_DIR=/opt/oempro/_dockerfiles/mysql/data_v8

# ============================================
# Backup Storage Settings
# ============================================

# Local backup directory (absolute path)
# Backups will be stored in subdirectories: daily/, weekly/, monthly/
BACKUP_DIR=/var/backups/octeth

# Temporary directory for backup preparation
# IMPORTANT: Must have enough space for full uncompressed database
# Recommended: Use a subdirectory under BACKUP_DIR or same disk with sufficient space
# Default /tmp often has limited space and will cause "No space left on device" errors
TEMP_DIR=/var/backups/octeth/tmp

# Maximum local disk usage threshold (percentage)
# Backup will abort if disk usage exceeds this
MAX_DISK_USAGE=85

# ============================================
# Compression Settings
# ============================================

# Compression tool: pigz (parallel gzip, faster) or gzip (standard)
# pigz will be auto-detected, fallback to gzip if not available
COMPRESSION_TOOL=auto

# Compression level (1-9, where 9 is maximum compression)
# Lower = faster but larger files, Higher = slower but smaller files
# Recommended: 6 for good balance
COMPRESSION_LEVEL=6

# ============================================
# Cloud Storage Settings
# ============================================

# Cloud storage provider: s3, gcs, or none
# s3 = Amazon S3, gcs = Google Cloud Storage, none = local only
CLOUD_STORAGE_PROVIDER=none

# ============================================
# S3 Storage Settings (AWS/DigitalOcean/MinIO)
# ============================================

# S3 bucket name (without s3:// prefix)
S3_BUCKET=my-octeth-backups

# S3 bucket region
S3_REGION=us-east-1

# S3 path prefix (optional, no leading/trailing slashes)
# Example: octeth/production or leave empty for bucket root
S3_PREFIX=octeth

# S3 storage class (STANDARD, STANDARD_IA, GLACIER_IR, etc.)
S3_STORAGE_CLASS=STANDARD_IA

# AWS credentials (if not using IAM role)
# Leave empty if using IAM instance profile
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

# S3 upload tool: awscli or rclone
S3_UPLOAD_TOOL=awscli

# rclone remote name (only if using rclone for S3)
RCLONE_REMOTE=s3

# ============================================
# Google Cloud Storage Settings (GCS)
# ============================================

# GCS bucket name (without gs:// prefix)
GCS_BUCKET=my-octeth-backups

# GCS project ID (optional, auto-detected from gcloud config if not set)
GCS_PROJECT_ID=

# GCS path prefix (optional, no leading/trailing slashes)
# Example: octeth/production or leave empty for bucket root
GCS_PREFIX=octeth

# GCS storage class (STANDARD, NEARLINE, COLDLINE, ARCHIVE)
GCS_STORAGE_CLASS=NEARLINE

# GCS upload tool: gsutil or rclone
GCS_UPLOAD_TOOL=gsutil

# rclone remote name (only if using rclone for GCS)
GCS_RCLONE_REMOTE=gcs

# Google Cloud credentials JSON file path (optional)
# Leave empty to use default gcloud credentials or service account
GOOGLE_APPLICATION_CREDENTIALS=

# ============================================
# Retention Policy Settings
# ============================================

# Keep last N daily backups
RETENTION_DAILY=7

# Keep last N weekly backups (Sunday backups)
RETENTION_WEEKLY=4

# Keep last N monthly backups (1st of month)
RETENTION_MONTHLY=6

# ============================================
# Notification Settings
# ============================================

# Enable email notifications (true/false)
EMAIL_NOTIFICATIONS=false

# Notification email addresses (comma-separated)
EMAIL_TO=admin@example.com,backup-admin@example.com

# Email from address
EMAIL_FROM=octeth-backup@example.com

# SMTP server settings
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your_email@gmail.com
SMTP_PASSWORD=your_app_password
SMTP_USE_TLS=true

# Notify only on failures (true) or always (false)
NOTIFY_ON_FAILURE_ONLY=true

# Webhook notification (optional)
WEBHOOK_ENABLED=false
WEBHOOK_URL=https://hooks.example.com/backup-status

# ============================================
# Advanced Settings
# ============================================

# Number of parallel compression threads
# auto = detect CPU cores, or specify a number
PARALLEL_THREADS=auto

# Verify backup after creation (true/false)
# This performs a prepare step to ensure backup is restorable
VERIFY_BACKUP=true

# Lock file location (prevents concurrent backups)
LOCK_FILE=/tmp/octeth-backup.lock

# Log file location
LOG_FILE=/var/log/octeth-backup.log

# Log retention days
LOG_RETENTION_DAYS=30

# Docker command (if using sudo)
# Use "sudo docker" if your user needs sudo for docker commands
DOCKER_CMD=docker

# Backup timeout in minutes (0 = no timeout)
BACKUP_TIMEOUT=120

# ============================================
# XtraBackup Settings
# ============================================

# XtraBackup binary path (auto-detected if in PATH)
XTRABACKUP_BIN=xtrabackup

# Additional XtraBackup options (advanced users)
# Example: --compress-threads=4 --throttle=100
XTRABACKUP_EXTRA_OPTS=
